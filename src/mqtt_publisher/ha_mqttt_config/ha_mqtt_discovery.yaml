discovery_topic:
  discovery_prefix: "homeassistant"
  component: "sensor"
  object_id: "twickenham_events"

topic_defaults:
  retain: "true"
  qos: "1"

generate_uuids: "true"

device:
  identifiers: "twickenham_events"
  name: "Twickenham Stadium Events"
  manufacturer: "RS"
  model: "Events"
  sw_version: "0.1"

origin:
  name: "Twickenham Stadium Events"
  sw_version: "0.1"
  support_url: "https://github.com/ronschaeffer/twickenham-events"

components:
  next:
    platform: "sensor"
    name: "Next Event"
    icon: "mdi:stadium"
    state_topic: "twick_events/next"
    value_template: "{{ value[0].date }}"
    json_attributes_topic: "twick_events/next"
    json_attributes_template: "{% set event = value[0] -%}\n{\n  \"fixture\": \"{{ event.fixture }}\",\n  \"start_time\": \"{{ event.start_time }}\",\n  \"end_time\": \"{{ event.end_time }}\",\n  \"crowd\": \"{{ event.crowd }}\"\n}" # This will extract event details from the first event in the data
    unique_id: "next"
    availability_topic: "twick_events/next/availability"

  upcoming:
    platform: "sensor"
    name: "Upcoming Events"
    value_template: "{{ value | length }}" # This will count the number of events in the data
    state_topic: "twick_events/all_upcoming" # This will be replaced with the 'all_upcoming' topic from config
    icon: "mdi:stadium"
    json_attributes_topic: "twick_events/all_upcoming" # This will be replaced with the 'all_upcoming' topic from config
    json_attributes_template: "{{ value | tojson }}" # This will convert the entire data to JSON
    unique_id: "upcoming"
    availability_topic: "twick_events/next/availability"
